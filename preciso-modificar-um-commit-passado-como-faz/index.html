<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" class="h-full" data-vue-tag="lang,class">
  <head>
    <title data-vue-tag="true">Preciso modificar um commit passado, como faz?  | Ana Rute</title><meta data-vue-tag="true" charset="utf-8"><meta data-vue-tag="true" name="generator" content="Gridsome v0.6.7"><meta data-vue-tag="true" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="true" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="true" data-key="description" name="description" content="Aprenda a usar rebase interativo para modificar um commit do passado"><meta data-vue-tag="true" property="og:type" content="article"><meta data-vue-tag="true" property="og:title" content="Preciso modificar um commit passado, como faz?"><meta data-vue-tag="true" property="og:description" content="Aprenda a usar rebase interativo para modificar um commit do passado"><meta data-vue-tag="true" property="og:url" content="https://anarute.com/preciso-modificar-um-commit-passado-como-faz/"><meta data-vue-tag="true" property="article:published_time" content="2020-09-13"><meta data-vue-tag="true" property="og:image" content="https://anarute.com/images/card.png"><meta data-vue-tag="true" name="twitter:card" content="summary_large_image"><meta data-vue-tag="true" name="twitter:title" content="Preciso modificar um commit passado, como faz?"><meta data-vue-tag="true" name="twitter:description" content="Aprenda a usar rebase interativo para modificar um commit do passado"><meta data-vue-tag="true" name="twitter:site" content="@ana_rute"><meta data-vue-tag="true" name="twitter:creator" content="@ana_rute"><meta data-vue-tag="true" name="twitter:image" content="https://anarute.com/images/card.png"><link data-vue-tag="true" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.1dbd3df.png"><link data-vue-tag="true" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.1dbd3df.png"><link data-vue-tag="true" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.1dbd3df.png"><link data-vue-tag="true" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.1dbd3df.png"><link data-vue-tag="true" rel="apple-touch-icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.1dbd3df.png"><link data-vue-tag="true" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans:400,700%7CCardo"><noscript data-vue-tag="true" ><style>.g-image--loading{display:none;}</style></noscript><link rel="preload" href="/assets/css/8.styles.387d894c.css" as="style"><link rel="preload" href="/assets/js/app.bda07300.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--post-vue.0bdbb1fb.js" as="script"><link rel="prefetch" href="/assets/js/10.ae06d815.js"><link rel="prefetch" href="/assets/js/page--src--pages--404-vue.9f2b73be.js"><link rel="prefetch" href="/assets/js/page--src--pages--about-vue.fe704e0d.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.f4c70c0d.js"><link rel="prefetch" href="/assets/js/page--src--templates--author-vue.83ae100a.js"><link rel="prefetch" href="/assets/js/page--src--templates--tag-vue.bbe5b039.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--index-vue~page--src--templates--author-vue~page--src--templates--post-vue~~a0fae544.1140ed21.js"><link rel="prefetch" href="/assets/js/vendors~page--src--templates--post-vue.f7aded5c.js"><link rel="stylesheet" href="/assets/css/8.styles.387d894c.css">
  </head>
  <body class="antialiased font-serif" data-vue-tag="class">
    <div data-server-rendered="true" id="app"><main><header><div class="pt-24"><div class="max-w-xl md:max-w-3xl xl:max-w-4xl mx-auto text-center px-6"><p class="text-gray-700 text-xs mb-2 uppercase">2 min read</p><h1 class="text-3xl sm:text-5xl leading-tight font-sans font-bold mb-2 text-black">Preciso modificar um commit passado, como faz?</h1><p class="text-gray-700"><span><a href="/author/anarute/" class="text-gray-700 border-b border-transparent hover:border-gray-400 transition-border-color">anarute</a> •
        </span><time datetime="2014-03-23 14:30:43" class="capitalize">23 March, 2014</time></p></div></div><nav class="absolute top-0 left-0 z-20 mt-6 ml-6"><a href="/" class="text-sm border opacity-75 hover:opacity-100 rounded-full px-4 py-2 transition-opacity active text-gray-900 border-gray-400">← Home</a></nav></header><article class="max-w-xl md:max-w-2xl xl:max-w-3xl mx-auto px-6 sm:px-12 pt-16"><div role="alert" class="leading-normal p-4 md:mx-6 mb-12 bg-orange-100 border-l-4 border-orange-500 text-orange-900">
        This post is over a year old, some of this information may be out of date.
      </div><div class="markdown text-lg leading-normal text-gray-700 pb-10"><blockquote>
<p>Nas últimas duas semanas tenho tido um intensivão de aprendizado de git por causa da reformulação do site da <a href="http://mupi.me" title="Escola Mupi" target="_blank" rel="nofollow noopener noreferrer">Escola Mupi</a>. O projeto usa como base uma plataforma que se chama <a href="https://github.com/hacklabr/timtec" title="Timtec" target="_blank" rel="nofollow noopener noreferrer">Timtec</a>, mas que ainda está sendo desenvolvida, logo muitos bugs, features faltando e muitos <em>merge conflicts</em>... Eu que ainda estou descobrindo as magias do git, tenho uma relacionamento de amor e ódio, pois já fiz muita besteira e perdi muitas horas de trabalho por não saber como ele funciona direito, assim como ele já me salvou muitas vezes &#x3C;3</p>
<p>Esses dias, precisei adicionar alguns arquivos num commit antigo para manter minha árvore organizada e coerente. Para isso, <a href="http://padovan.org" title="Gustavo Padovan" target="_blank" rel="nofollow noopener noreferrer">@padovan</a> me ensinou a resolver esse problema usando <strong>fixup</strong> + <strong>rebase interactive</strong> [que eu particularmente achei incrível]. Vamos lá:</p>
</blockquote>
<p>Antes de iniciar, você precisa copiar um pedaço inicial do hash do commit que você deseja modificar. O hash é o código de identificação do commit, exemplo: 636bf2643e67bf34f67691333b916e292571a469. No caso os 6 primeiros caracteres já são suficientes. Você pode achar o hash com o comando <span style="color: #800000;"><code class="shiki-inline" style="background: #2e3440; color: #d8dee9">git log</code></span>.</p>
<p>Tendo isso copiado, deve-se fazer um "fake" commit. Ou seja, criamos um commit que servirá apenas como um repositório temporário das novas modificações que serão acrescentadas ao commit desejado. Para isso usamos o seguinte comando:</p>
<pre>$ git commit --fixup=636bf26</pre>
<p>Isso cria um commit com a mensagem "fixup! + msg do commit selecionado". Isso ajuda a identificar que esse não é um commit convencional, mas que precisa ser "fixed up". Feito isso, agora vem a magia: <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">git rebase --interactive</code> ou <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">git rebase -i</code>. O rebase interactive dá muito mais flexibilidade para modificar os commits. Para usá-lo precisamos indicar a quantidade de últimos commits a serem mostrados a partir do HEAD. No meu caso, os 4 últimos commits foram suficientes:</p>
<pre>$ git rebase -i HEAD~4</pre>
<p>que nos dá no editor padrão do terminal a quantidade indicada de commits em ordem do mais antigo ao mais novo, assim como todas as opções do <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">rebase interactive</code>. Nesse exemplo só vamos utilizar fixup (note que existem outras opções pra rebase interativo que podem ser muito úteis em outras situações):</p>
<p><img src="http://i.imgur.com/U0abklc.png"></p>
<p>Para a magia acontecer, é preciso escrever <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">f</code> no lugar de <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">pick</code> na frente do commit de fixup e modificar a ordem dos commits, colocando-o logo abaixo do commit desejado:</p>
<p><img src="http://i.imgur.com/qb8mwCx.png"></p>
<p>Agora é só salvar e voi lá! o "fake" commit é fundido no commit de cima =) é só dar um checada se deu tudo certo com git log.</p>
<p>UPDATE: Como pode se ver na primeira imagem, existem outras opções bem interessantes para se usar no rebase interativo, como o <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">reword</code>, que permite modificar apenas a mensagem de algum commit, e o <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">squash</code> que permite juntar dois ou mais commits em um só. Para quem lê em inglês, sugiro <a href="https://help.github.com/articles/interactive-rebase" title="Interactive rebase" target="_blank" rel="nofollow noopener noreferrer">este artigo</a> do github a respeito e dou um quote de alerta (tradução livre minha): "É considerada uma má prática dar rebase em commits que já foram submetidos ao repositório remoto. Ao fazer isso, você poderá invocar a ira dos deuses do git".</p>
<p>obs.: Para modificar o último commit feito, <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">git commit --amend</code> é a melhor opção, já que "reabre" o último commit para edição.</p>
</div><footer class="flex flex-wrap pb-10 sm:pb-16"><div><a href="/tag/git/" class="inline-block text-teal-400 hover:text-white hover:bg-teal-400 border border-teal-400 font-sans font-bold text-xs sm:text-sm px-4 py-2 mr-4 mb-2 rounded-full transition-color transition-bg"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" role="img" class="inline w-3 fill-current align-middle mr-1"><path d="M0 10V2l2-2h8l10 10-10 10L0 10zm4.5-4a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"></path></svg>
          git
          </a></div><div class="flex flex-wrap items-center justify-center sm:justify-left border-t border-b border-gray-300 w-full mt-10 py-10 sm:px-16"><figure class="px-2 mb-1 sm:mb-0 w-full sm:w-1/5 flex justify-center"><a href="/author/anarute/"><img src="/images/authors/anarute.png" alt="anarute" width="100" class="rounded-full p-4 sm:p-0"></a></figure><div class="px-4 sm:w-4/5 text-center sm:text-left"><h4 class="font-sans font-bold text-lg sm:text-xl mb-2 sm:mb-4"><a href="/author/anarute/" class="text-black hover:text-gray-600 border-b-2 border-transparent transition-color">anarute</a></h4><p class="leading-normal"><a href="/author/anarute/" class="text-blue-500 hover:text-blue-400 transition-color">See all posts by anarute →</a></p></div></div></footer><div id="disqus_thread"></div></article><footer class="text-gray-700 text-sm leading-normal flex flex-wrap justify-between mx-auto max-w-3xl px-6 sm:px-12 pb-8 sm:pb-10"><div class="w-full sm:w-1/2 mb-4 sm:mb-0"><p>Based on <a href="https://github.com/cossssmin/gridsome-starter-bleda" class="border-b border-transparent hover:border-gray-400 transition-border-color">Bleda</a> by <a href="https://twitter.com/cossssmin" class="border-b border-transparent hover:border-gray-400 transition-border-color">@cossssmin</a></p></div><div class="w-full sm:w-1/2"><nav><ul class="flex sm:justify-end -mx-2"><li class="px-2"><a href="/" class="border-b border-transparent hover:border-gray-400 transition-border-color active">Home</a></li><li class="px-2"><a href="/about/" class="border-b border-transparent hover:border-gray-400 transition-border-color">About</a></li><li class="px-2"><a href="/sitemap.xml" class="border-b border-transparent hover:border-gray-400 transition-border-color">Sitemap</a></li><li class="px-2"><a href="/feed.xml" class="border-b border-transparent hover:border-gray-400 transition-border-color">RSS Feed</a></li></ul></nav></div></footer></main></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"title":"Preciso modificar um commit passado, como faz?","slug":"preciso-modificar-um-commit-passado-como-faz","datetime":"2014-03-23 14:30:43","content":"\u003Cblockquote\u003E\n\u003Cp\u003ENas últimas duas semanas tenho tido um intensivão de aprendizado de git por causa da reformulação do site da \u003Ca href=\"http:\u002F\u002Fmupi.me\" title=\"Escola Mupi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EEscola Mupi\u003C\u002Fa\u003E. O projeto usa como base uma plataforma que se chama \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fhacklabr\u002Ftimtec\" title=\"Timtec\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003ETimtec\u003C\u002Fa\u003E, mas que ainda está sendo desenvolvida, logo muitos bugs, features faltando e muitos \u003Cem\u003Emerge conflicts\u003C\u002Fem\u003E... Eu que ainda estou descobrindo as magias do git, tenho uma relacionamento de amor e ódio, pois já fiz muita besteira e perdi muitas horas de trabalho por não saber como ele funciona direito, assim como ele já me salvou muitas vezes &#x3C;3\u003C\u002Fp\u003E\n\u003Cp\u003EEsses dias, precisei adicionar alguns arquivos num commit antigo para manter minha árvore organizada e coerente. Para isso, \u003Ca href=\"http:\u002F\u002Fpadovan.org\" title=\"Gustavo Padovan\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003E@padovan\u003C\u002Fa\u003E me ensinou a resolver esse problema usando \u003Cstrong\u003Efixup\u003C\u002Fstrong\u003E + \u003Cstrong\u003Erebase interactive\u003C\u002Fstrong\u003E [que eu particularmente achei incrível]. Vamos lá:\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003EAntes de iniciar, você precisa copiar um pedaço inicial do hash do commit que você deseja modificar. O hash é o código de identificação do commit, exemplo: 636bf2643e67bf34f67691333b916e292571a469. No caso os 6 primeiros caracteres já são suficientes. Você pode achar o hash com o comando \u003Cspan style=\"color: #800000;\"\u003E\u003Ccode class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\"\u003Egit log\u003C\u002Fcode\u003E\u003C\u002Fspan\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003ETendo isso copiado, deve-se fazer um \"fake\" commit. Ou seja, criamos um commit que servirá apenas como um repositório temporário das novas modificações que serão acrescentadas ao commit desejado. Para isso usamos o seguinte comando:\u003C\u002Fp\u003E\n\u003Cpre\u003E$ git commit --fixup=636bf26\u003C\u002Fpre\u003E\n\u003Cp\u003EIsso cria um commit com a mensagem \"fixup! + msg do commit selecionado\". Isso ajuda a identificar que esse não é um commit convencional, mas que precisa ser \"fixed up\". Feito isso, agora vem a magia: \u003Ccode class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\"\u003Egit rebase --interactive\u003C\u002Fcode\u003E ou \u003Ccode class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\"\u003Egit rebase -i\u003C\u002Fcode\u003E. O rebase interactive dá muito mais flexibilidade para modificar os commits. Para usá-lo precisamos indicar a quantidade de últimos commits a serem mostrados a partir do HEAD. No meu caso, os 4 últimos commits foram suficientes:\u003C\u002Fp\u003E\n\u003Cpre\u003E$ git rebase -i HEAD~4\u003C\u002Fpre\u003E\n\u003Cp\u003Eque nos dá no editor padrão do terminal a quantidade indicada de commits em ordem do mais antigo ao mais novo, assim como todas as opções do \u003Ccode class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\"\u003Erebase interactive\u003C\u002Fcode\u003E. Nesse exemplo só vamos utilizar fixup (note que existem outras opções pra rebase interativo que podem ser muito úteis em outras situações):\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"http:\u002F\u002Fi.imgur.com\u002FU0abklc.png\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EPara a magia acontecer, é preciso escrever \u003Ccode class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\"\u003Ef\u003C\u002Fcode\u003E no lugar de \u003Ccode class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\"\u003Epick\u003C\u002Fcode\u003E na frente do commit de fixup e modificar a ordem dos commits, colocando-o logo abaixo do commit desejado:\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"http:\u002F\u002Fi.imgur.com\u002Fqb8mwCx.png\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EAgora é só salvar e voi lá! o \"fake\" commit é fundido no commit de cima =) é só dar um checada se deu tudo certo com git log.\u003C\u002Fp\u003E\n\u003Cp\u003EUPDATE: Como pode se ver na primeira imagem, existem outras opções bem interessantes para se usar no rebase interativo, como o \u003Ccode class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\"\u003Ereword\u003C\u002Fcode\u003E, que permite modificar apenas a mensagem de algum commit, e o \u003Ccode class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\"\u003Esquash\u003C\u002Fcode\u003E que permite juntar dois ou mais commits em um só. Para quem lê em inglês, sugiro \u003Ca href=\"https:\u002F\u002Fhelp.github.com\u002Farticles\u002Finteractive-rebase\" title=\"Interactive rebase\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Eeste artigo\u003C\u002Fa\u003E do github a respeito e dou um quote de alerta (tradução livre minha): \"É considerada uma má prática dar rebase em commits que já foram submetidos ao repositório remoto. Ao fazer isso, você poderá invocar a ira dos deuses do git\".\u003C\u002Fp\u003E\n\u003Cp\u003Eobs.: Para modificar o último commit feito, \u003Ccode class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\"\u003Egit commit --amend\u003C\u002Fcode\u003E é a melhor opção, já que \"reabre\" o último commit para edição.\u003C\u002Fp\u003E\n","description":"Aprenda a usar rebase interativo para modificar um commit do passado","timeToRead":2,"cover":"","fullscreen":false,"author":{"id":"anarute","title":"anarute","path":"\u002Fauthor\u002Fanarute"},"tags":[{"id":"git","title":"git","path":"\u002Ftag\u002Fgit"}]}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.bda07300.js" defer></script><script src="/assets/js/page--src--templates--post-vue.0bdbb1fb.js" defer></script>
  </body>
</html>
