<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" class="h-full" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D,%22class%22:%7B%22ssr%22:%22h-full%22%7D%7D">
  <head>
    <title>Preciso modificar um commit passado, como faz?  | Ana Rute</title><meta name="gridsome:hash" content="752c6ce69aa6bc2761e11346ad248f842b46c834"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="description" name="description" content="Aprenda a usar rebase interativo para modificar um commit do passado"><meta data-vue-tag="ssr" property="og:type" content="article"><meta data-vue-tag="ssr" property="og:title" content="Preciso modificar um commit passado, como faz?"><meta data-vue-tag="ssr" property="og:description" content="Aprenda a usar rebase interativo para modificar um commit do passado"><meta data-vue-tag="ssr" property="og:url" content="https://anarute.com/preciso-modificar-um-commit-passado-como-faz/"><meta data-vue-tag="ssr" property="article:published_time" content="2023-08-14"><meta data-vue-tag="ssr" property="og:image" content="https://anarute.com/images/card.png"><meta data-vue-tag="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-tag="ssr" name="twitter:title" content="Preciso modificar um commit passado, como faz?"><meta data-vue-tag="ssr" name="twitter:description" content="Aprenda a usar rebase interativo para modificar um commit do passado"><meta data-vue-tag="ssr" name="twitter:site" content="@ana_rute"><meta data-vue-tag="ssr" name="twitter:creator" content="@ana_rute"><meta data-vue-tag="ssr" name="twitter:image" content="https://anarute.com/images/card.png"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.1dbd3df5a133ad4bfceee6f845dec19f.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.1dbd3df5a133ad4bfceee6f845dec19f.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.1dbd3df5a133ad4bfceee6f845dec19f.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.1dbd3df5a133ad4bfceee6f845dec19f.png"><link data-vue-tag="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans:400,700%7CCardo"><link rel="preload" href="/assets/css/10.styles.71c6ed44.css" as="style"><link rel="preload" href="/assets/js/app.0aaf7b86.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--post-vue.910010bc.js" as="script"><link rel="prefetch" href="/assets/js/12.bf723347.js"><link rel="prefetch" href="/assets/js/page--src--pages--404-vue.f874ac3a.js"><link rel="prefetch" href="/assets/js/page--src--pages--about-vue.d8cccfac.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.c4d60db6.js"><link rel="prefetch" href="/assets/js/page--src--pages--talks-vue.fb1d0092.js"><link rel="prefetch" href="/assets/js/page--src--pages--uses-vue.3f17494c.js"><link rel="prefetch" href="/assets/js/page--src--templates--author-vue.4fa776a2.js"><link rel="prefetch" href="/assets/js/page--src--templates--tag-vue.18e80999.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--index-vue~page--src--templates--author-vue~page--src--templates--post-vue~~a0fae544.81352eac.js"><link rel="prefetch" href="/assets/js/vendors~page--src--templates--post-vue.989aa289.js"><link rel="stylesheet" href="/assets/css/10.styles.71c6ed44.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body class="antialiased font-serif" data-vue-tag="%7B%22class%22:%7B%22ssr%22:%22antialiased%20font-serif%22%7D%7D">
    <div data-server-rendered="true" id="app" class="layout"><section class="menu"><div><nav><ul><li><a href="/" class="active">posts</a></li><li><a href="/about/">about</a></li><li><a href="/uses/">setup</a></li><li><a href="/talks/">talks</a></li><li><a href="/feed.xml">RSS Feed</a></li></ul></nav></div></section><main><header><div><div><h1>Preciso modificar um commit passado, como faz?</h1><p><span><a href="/author/anarute/">anarute</a>
          •
        </span><time datetime="2014-03-23 14:30:43">23 March, 2014</time></p></div></div></header><article><div role="alert" class="warning">
        This post is over a year old, some of this information may be out of
        date.
      </div><div><blockquote>
<p>Nas últimas duas semanas tenho tido um intensivão de aprendizado de git por causa da reformulação do site da <a href="http://mupi.me" title="Escola Mupi" target="_blank" rel="nofollow noopener noreferrer">Escola Mupi</a>. O projeto usa como base uma plataforma que se chama <a href="https://github.com/hacklabr/timtec" title="Timtec" target="_blank" rel="nofollow noopener noreferrer">Timtec</a>, mas que ainda está sendo desenvolvida, logo muitos bugs, features faltando e muitos <em>merge conflicts</em>... Eu que ainda estou descobrindo as magias do git, tenho uma relacionamento de amor e ódio, pois já fiz muita besteira e perdi muitas horas de trabalho por não saber como ele funciona direito, assim como ele já me salvou muitas vezes &#x3C;3</p>
<p>Esses dias, precisei adicionar alguns arquivos num commit antigo para manter minha árvore organizada e coerente. Para isso, <a href="http://padovan.org" title="Gustavo Padovan" target="_blank" rel="nofollow noopener noreferrer">@padovan</a> me ensinou a resolver esse problema usando <strong>fixup</strong> + <strong>rebase interactive</strong> [que eu particularmente achei incrível]. Vamos lá:</p>
</blockquote>
<p>Antes de iniciar, você precisa copiar um pedaço inicial do hash do commit que você deseja modificar. O hash é o código de identificação do commit, exemplo: 636bf2643e67bf34f67691333b916e292571a469. No caso os 6 primeiros caracteres já são suficientes. Você pode achar o hash com o comando <span style="color: #800000;"><code class="shiki-inline" style="background: #2e3440; color: #d8dee9">git log</code></span>.</p>
<p>Tendo isso copiado, deve-se fazer um "fake" commit. Ou seja, criamos um commit que servirá apenas como um repositório temporário das novas modificações que serão acrescentadas ao commit desejado. Para isso usamos o seguinte comando:</p>
<pre>$ git commit --fixup=636bf26</pre>
<p>Isso cria um commit com a mensagem "fixup! + msg do commit selecionado". Isso ajuda a identificar que esse não é um commit convencional, mas que precisa ser "fixed up". Feito isso, agora vem a magia: <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">git rebase --interactive</code> ou <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">git rebase -i</code>. O rebase interactive dá muito mais flexibilidade para modificar os commits. Para usá-lo precisamos indicar a quantidade de últimos commits a serem mostrados a partir do HEAD. No meu caso, os 4 últimos commits foram suficientes:</p>
<pre>$ git rebase -i HEAD~4</pre>
<p>que nos dá no editor padrão do terminal a quantidade indicada de commits em ordem do mais antigo ao mais novo, assim como todas as opções do <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">rebase interactive</code>. Nesse exemplo só vamos utilizar fixup (note que existem outras opções pra rebase interativo que podem ser muito úteis em outras situações):</p>
<p><img src="http://i.imgur.com/U0abklc.png"></p>
<p>Para a magia acontecer, é preciso escrever <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">f</code> no lugar de <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">pick</code> na frente do commit de fixup e modificar a ordem dos commits, colocando-o logo abaixo do commit desejado:</p>
<p><img src="http://i.imgur.com/qb8mwCx.png"></p>
<p>Agora é só salvar e voi lá! o "fake" commit é fundido no commit de cima =) é só dar um checada se deu tudo certo com git log.</p>
<p>UPDATE: Como pode se ver na primeira imagem, existem outras opções bem interessantes para se usar no rebase interativo, como o <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">reword</code>, que permite modificar apenas a mensagem de algum commit, e o <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">squash</code> que permite juntar dois ou mais commits em um só. Para quem lê em inglês, sugiro <a href="https://help.github.com/articles/interactive-rebase" title="Interactive rebase" target="_blank" rel="nofollow noopener noreferrer">este artigo</a> do github a respeito e dou um quote de alerta (tradução livre minha): "É considerada uma má prática dar rebase em commits que já foram submetidos ao repositório remoto. Ao fazer isso, você poderá invocar a ira dos deuses do git".</p>
<p>obs.: Para modificar o último commit feito, <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">git commit --amend</code> é a melhor opção, já que "reabre" o último commit para edição.</p>
</div><footer><div><a href="/tag/git/" class="tag">
            git
          </a></div></footer><div id="disqus_thread"></div></article></main></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"title":"Preciso modificar um commit passado, como faz?","slug":"preciso-modificar-um-commit-passado-como-faz","datetime":"2014-03-23 14:30:43","content":"\u003Cblockquote\u003E\n\u003Cp\u003ENas últimas duas semanas tenho tido um intensivão de aprendizado de git por causa da reformulação do site da \u003Ca href=\"http:\u002F\u002Fmupi.me\" title=\"Escola Mupi\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EEscola Mupi\u003C\u002Fa\u003E. O projeto usa como base uma plataforma que se chama \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fhacklabr\u002Ftimtec\" title=\"Timtec\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003ETimtec\u003C\u002Fa\u003E, mas que ainda está sendo desenvolvida, logo muitos bugs, features faltando e muitos \u003Cem\u003Emerge conflicts\u003C\u002Fem\u003E... Eu que ainda estou descobrindo as magias do git, tenho uma relacionamento de amor e ódio, pois já fiz muita besteira e perdi muitas horas de trabalho por não saber como ele funciona direito, assim como ele já me salvou muitas vezes &#x3C;3\u003C\u002Fp\u003E\n\u003Cp\u003EEsses dias, precisei adicionar alguns arquivos num commit antigo para manter minha árvore organizada e coerente. Para isso, \u003Ca href=\"http:\u002F\u002Fpadovan.org\" title=\"Gustavo Padovan\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003E@padovan\u003C\u002Fa\u003E me ensinou a resolver esse problema usando \u003Cstrong\u003Efixup\u003C\u002Fstrong\u003E + \u003Cstrong\u003Erebase interactive\u003C\u002Fstrong\u003E [que eu particularmente achei incrível]. Vamos lá:\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003EAntes de iniciar, você precisa copiar um pedaço inicial do hash do commit que você deseja modificar. O hash é o código de identificação do commit, exemplo: 636bf2643e67bf34f67691333b916e292571a469. No caso os 6 primeiros caracteres já são suficientes. Você pode achar o hash com o comando \u003Cspan style=\"color: #800000;\"\u003E\u003Ccode class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\"\u003Egit log\u003C\u002Fcode\u003E\u003C\u002Fspan\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003ETendo isso copiado, deve-se fazer um \"fake\" commit. Ou seja, criamos um commit que servirá apenas como um repositório temporário das novas modificações que serão acrescentadas ao commit desejado. Para isso usamos o seguinte comando:\u003C\u002Fp\u003E\n\u003Cpre\u003E$ git commit --fixup=636bf26\u003C\u002Fpre\u003E\n\u003Cp\u003EIsso cria um commit com a mensagem \"fixup! + msg do commit selecionado\". Isso ajuda a identificar que esse não é um commit convencional, mas que precisa ser \"fixed up\". Feito isso, agora vem a magia: \u003Ccode class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\"\u003Egit rebase --interactive\u003C\u002Fcode\u003E ou \u003Ccode class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\"\u003Egit rebase -i\u003C\u002Fcode\u003E. O rebase interactive dá muito mais flexibilidade para modificar os commits. Para usá-lo precisamos indicar a quantidade de últimos commits a serem mostrados a partir do HEAD. No meu caso, os 4 últimos commits foram suficientes:\u003C\u002Fp\u003E\n\u003Cpre\u003E$ git rebase -i HEAD~4\u003C\u002Fpre\u003E\n\u003Cp\u003Eque nos dá no editor padrão do terminal a quantidade indicada de commits em ordem do mais antigo ao mais novo, assim como todas as opções do \u003Ccode class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\"\u003Erebase interactive\u003C\u002Fcode\u003E. Nesse exemplo só vamos utilizar fixup (note que existem outras opções pra rebase interativo que podem ser muito úteis em outras situações):\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"http:\u002F\u002Fi.imgur.com\u002FU0abklc.png\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EPara a magia acontecer, é preciso escrever \u003Ccode class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\"\u003Ef\u003C\u002Fcode\u003E no lugar de \u003Ccode class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\"\u003Epick\u003C\u002Fcode\u003E na frente do commit de fixup e modificar a ordem dos commits, colocando-o logo abaixo do commit desejado:\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"http:\u002F\u002Fi.imgur.com\u002Fqb8mwCx.png\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EAgora é só salvar e voi lá! o \"fake\" commit é fundido no commit de cima =) é só dar um checada se deu tudo certo com git log.\u003C\u002Fp\u003E\n\u003Cp\u003EUPDATE: Como pode se ver na primeira imagem, existem outras opções bem interessantes para se usar no rebase interativo, como o \u003Ccode class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\"\u003Ereword\u003C\u002Fcode\u003E, que permite modificar apenas a mensagem de algum commit, e o \u003Ccode class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\"\u003Esquash\u003C\u002Fcode\u003E que permite juntar dois ou mais commits em um só. Para quem lê em inglês, sugiro \u003Ca href=\"https:\u002F\u002Fhelp.github.com\u002Farticles\u002Finteractive-rebase\" title=\"Interactive rebase\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Eeste artigo\u003C\u002Fa\u003E do github a respeito e dou um quote de alerta (tradução livre minha): \"É considerada uma má prática dar rebase em commits que já foram submetidos ao repositório remoto. Ao fazer isso, você poderá invocar a ira dos deuses do git\".\u003C\u002Fp\u003E\n\u003Cp\u003Eobs.: Para modificar o último commit feito, \u003Ccode class=\"shiki-inline\" style=\"background: #2e3440; color: #d8dee9\"\u003Egit commit --amend\u003C\u002Fcode\u003E é a melhor opção, já que \"reabre\" o último commit para edição.\u003C\u002Fp\u003E\n","description":"Aprenda a usar rebase interativo para modificar um commit do passado","cover":"","fullscreen":false,"author":{"id":"anarute","title":"anarute","path":"\u002Fauthor\u002Fanarute\u002F"},"tags":[{"id":"git","title":"git","path":"\u002Ftag\u002Fgit\u002F"}]}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.0aaf7b86.js" defer></script><script src="/assets/js/page--src--templates--post-vue.910010bc.js" defer></script>
  </body>
</html>
